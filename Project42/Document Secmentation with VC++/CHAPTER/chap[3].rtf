{\rtf1\adeflang1054\ansi\ansicpg874\uc1\adeff28 \deff0\deflang1033\deflangfe1033{\fonttbl{\f3\froman\fcharset2\fprq2{\*\panose 05050102010706020507}Symbol;}{\f27\froman\fcharset0\fprq2{\*\panose 02020603050405020304}Angsana New;}{\f28\fswiss\fcharset0\fprq2{\*\panose 020b0304020202020204}Cordia New;}{\f33\froman\fcharset222\fprq2{\*\panose 02020603050405020304}AngsanaUPC;}{\f314\froman\fcharset222\fprq2 Angsana New;}{\f324\fswiss\fcharset222\fprq2 Cordia New;}}{\colortbl;\red0\green0\blue0;\red0\green0\blue255;\red0\green255\blue255;\red0\green255\blue0;\red255\green0\blue255;\red255\green0\blue0;\red255\green255\blue0;\red255\green255\blue255;\red0\green0\blue128;\red0\green128\blue128;\red0\green128\blue0;\red128\green0\blue128;\red128\green0\blue0;\red128\green128\blue0;\red128\green128\blue128;\red192\green192\blue192;}{\stylesheet{\ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\f28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 \snext0 Normal;}{\*\cs10 \additive Default Paragraph Font;}{\s15\ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\f28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 \sbasedon0 \snext15 Plain Text;}{\s16\qt \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af33\afs30\cgrid\langnp1033\langfenp1033 \fcs0 \fs30\lang1033\langfe1033\loch\f28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 \sbasedon0 \snext16 Body Text;}{\s17\ql \li0\ri0\widctlpar\tqc\tx4153\tqr\tx8306\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\f28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 \sbasedon0 \snext17 header;}{\*\cs18 \additive \fcs1 \af0 \fcs0 \sbasedon10 page number;}}{\*\listtable{\list\listtemplateid69074945\listsimple{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'01\u-3913 ?;}{\levelnumbers;}\f3\lang0\langfe0\chbrdr\brdrnone\brdrcf1 \chshdng0\chcfpat1\chcbpat1\fbias0 \fi-360\li360\jclisttab\tx360 }{\listname ;}\listid1287854608}}{\*\listoverridetable{\listoverride\listid1287854608\listoverridecount0\ls1}}{\info{\title บทที่ 3}{\author ac_club}{\operator Pop Sompalasin}{\creatim\yr2000\mo3\dy25\hr11\min28}{\revtim\yr2000\mo3\dy25\hr11\min28}{\printim\yr2000\mo3\dy23\hr8\min34}{\version2}{\edmins0}{\nofpages10}{\nofwords1867}{\nofchars10642}{\*\company K.M.I.T 'Ladkrabang}{\nofcharsws13069}{\vern8197}}\paperw11906\paperh16838\margl1440\margr1440 \widowctrl\ftnbj\aenddoc\pgnstart17\noxlattoyen\expshrtn\noultrlspc\dntblnsbdb\nospaceforul\formshade\horzdoc\dghspace180\dgvspace180\dghorigin1701\dgvorigin1984\dghshow0\dgvshow0\jexpand\viewkind1\viewscale100\pgbrdrhead\pgbrdrfoot\nolnhtadjtbl \fet0\sectd \pgnrestart\pgnstarts17\linex0\headery706\footery706\endnhere\sectdefaultcl {\header \pard\plain \s17\ql \li0\ri0\widctlpar\tqc\tx4153\tqr\tx8306\pvpara\phmrg\posxr\posy0\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\af28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 {\field{\*\fldinst {\fcs1 \cs18\af28 \fcs0 \cs18 \hich\af28\dbch\af28\loch\f28 PAGE  }}{\fldrslt {\fcs1 \cs18\af28\noproof \fcs0 \cs18\lang1024\langfe1024\noproof \hich\af28\dbch\af28\loch\f28 17}}}{\fcs1 \cs18\af28 \fcs0 \cs18 
\par }\pard \s17\ql \li0\ri360\widctlpar\tqc\tx4153\tqr\tx8306\aspalpha\aspnum\faauto\adjustright\rin360\lin0\itap0 {\fcs1 \af28 \fcs0 
\par }}{\*\pnseclvl1\pnucrm\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl2\pnucltr\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl3\pndec\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl4\pnlcltr\pnstart1\pnindent720\pnhang{\pntxta )}}{\*\pnseclvl5\pndec\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl6\pnlcltr\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl7\pnlcrm\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl8\pnlcltr\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl9\pnlcrm\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}\pard\plain \qc \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\af28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 {\fcs0 \ab\af314\afs44 \fcs1 \b\f314\fs44\lang1054 บทที่ }{\fcs1 \ab\af27\afs44 \fcs0 \b\f27\fs44 \hich\af27\dbch\af28\loch\f27 3
\par }{\fcs0 \ab\af314\afs44 \fcs1 \b\f314\fs44\lang1054 การเข้าถึงและการจัดการข้อมูลรูปภาพ}{\fcs1 \ab\af27\afs44 \fcs0 \b\f27\fs44 
\par }\pard \ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 {\fcs1 \ab\af27\afs44 \fcs0 \b\f27\fs44 
\par }{\fcs1 \ab\af27\afs30 \fcs0 \b\f27\fs30 \hich\af27\dbch\af28\loch\f27 3.1}{\fcs0 \ab\af314\afs30 \fcs1 \b\f314\fs30\lang1054  การเข้าถึงข้อมูลรูปภาพ}{\fcs1 \ab\af27\afs30 \fcs0 \b\f27\fs30 
\par }\pard \qt \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 {\fcs1 \ab\af27\afs30 \fcs0 \b\f27\fs30 \tab }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 ในการเข้าถึงข้อมูลของรูปภาพโดยใช้โปรแกรม }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 Microsoft Visual C++ }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 จะต้องมีการเรียกใช้ฟังก์ชันของ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 MFC }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 หลายฟังก์ชัน โดยแต่ละฟังก์ชันจะทำหน้าที่ต่างๆกันดังนี้}{\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par 
\par }{\fcs1 \ab\af27\afs30 \fcs0 \b\f27\fs30 \hich\af27\dbch\af28\loch\f27 3.1.1}{\fcs0 \ab\af314\afs30 \fcs1 \b\f314\fs30\lang1054  ฟังก์ชัน }{\fcs1 \ab\af27\afs30 \fcs0 \b\f27\fs30 \hich\af27\dbch\af28\loch\f27 BitmapDC 
\par }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \tab }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 จะทำหน้าที่เป็นฟังก์ชันคอนสตรัคเตอร์ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 (Constructor) }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 ซึ่งจะเป็นฟังก์ชันที่จะถูกเรียกให้ทำงาน เมื่อมีการสร้างออบเจ็กต์ของคลาสเกิดขึ้น โดยลักษณะของคอนสตรัคเตอร์ จะเป็นฟังก์ชันหนึ่งที่อยู่ภายในคลาส โดยจะมีชื่อฟังก์ชันเหมือนกับชื่อคลาส ฟังก์ชันคอนสตรัคเตอร์ของการโหลดรูปภาพบิตแมบจะแสดงด้านล่าง}{\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par 
\par }\pard\plain \s15\ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\af28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27  [1]\tab BitmapDC :: BitmapDC () \{
\par \hich\af27\dbch\af28\loch\f27  [2]\tab // ptrpalette = NULL;
\par \hich\af27\dbch\af28\loch\f27  [3]\tab  hbmpdc     = 0;
\par \hich\af27\dbch\af28\loch\f27  [4]\tab  hbmp       = 0;
\par \hich\af27\dbch\af28\loch\f27  [5]\tab  height     = 0;
\par \hich\af27\dbch\af28\loch\f27  [6]\tab  width      = 0;
\par \hich\af27\dbch\af28\loch\f27  [7]\tab  isvalid    = FALSE;
\par \hich\af27\dbch\af28\loch\f27  [8]\tab \}
\par \hich\af27\dbch\af28\loch\f27  [9]\tab BitmapDC::BitmapDC (long w, long h, Palette \hich\af27\dbch\af28\loch\f27 * ptrPal) \{
\par \hich\af27\dbch\af28\loch\f27  [10]\tab  hbmpdc     = 0;
\par \hich\af27\dbch\af28\loch\f27  [11]\tab  hbmp       = 0;
\par \hich\af27\dbch\af28\loch\f27  [12]\tab  height     = h;
\par \hich\af27\dbch\af28\loch\f27  [13]\tab  width      = w; 
\par \hich\af27\dbch\af28\loch\f27  [14]\tab  isvalid = Create(w, h, ptrPal);
\par \hich\af27\dbch\af28\loch\f27  [15]\tab \}
\par \hich\af27\dbch\af28\loch\f27  [16]\tab BitmapDC::BitmapDC (long w, long h, BYTE *pbit, Palette *ptrPal) \{
\par \hich\af27\dbch\af28\loch\f27  [17]\tab  hbmpdc     = 0;
\par \hich\af27\dbch\af28\loch\f27  [18]\tab  h\hich\af27\dbch\af28\loch\f27 bmp       = 0;
\par \hich\af27\dbch\af28\loch\f27  [19]\tab  height     = h;
\par \hich\af27\dbch\af28\loch\f27  [20]\tab  width      = w; 
\par \hich\af27\dbch\af28\loch\f27  [21]\tab  isvalid = Create(w, h, ptrPal);
\par \hich\af27\dbch\af28\loch\f27  [22]\tab  SetBits(pbit);
\par }\pard\plain \qt \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\af28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27  [23]\tab \}
\par 
\par \tab }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 ฟังก์ชัน }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 BitmapDC }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 นี้จะทำหน้าที่ในการกำหนดค่าเริ่มต้นของรูปภาพว่า มีขนาดมีส่วนสูง หรือมีขนาดเท่าใด มีการกำหนดตัวชี้ของรูปภาพ}{\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par \hich\af27\dbch\af28\loch\f27  \tab }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 ในบรรทัดที่ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 1, 9, 16}{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054  จะแสดงถึงฟังก์ชันคอนสตรัคเตอร์ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 3}{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054  แบบโดยแบบแรกจะไม่ต้องใส่พารามิเตอร์ใดเลย แต่ใน }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 2}{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054  แบบหลังจะต้องอาศัยพารามิเตอร์ด้วย โดยในแต่ละแบบจะมีการกำหนดตัวแปรที่เหมือนกันคือ}{\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par {\pntext\pard\plain\fcs1 \af27\afs30 \fcs0 \fs30\loch\af3\hich\af3\dbch\af28 \loch\af3\dbch\af28\hich\f3 \'b7\tab}}\pard \qt \fi-360\li1080\ri0\widctlpar\jclisttab\tx1080{\*\pn \pnlvlblt\ilvl0\ls1\pnrnot0\pnf3\pnstart1\pnindent360\pnsp120\pnhang{\pntxtb \'b7}}\aspalpha\aspnum\faauto\ls1\adjustright\rin0\lin1080\itap0 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 hbmpdc }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 จะเป็นตัวแปรที่จะเก็บตัวชี้ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 (Handle) }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 ที่ชี้ไปที่อาเรย์ของรูปภาพบิตแมบ เพื่อไว้ใช้แสดงผลออกสู่หน้าจอ}{\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par {\pntext\pard\plain\fcs1 \af27\afs30 \fcs0 \fs30\loch\af3\hich\af3\dbch\af28 \loch\af3\dbch\af28\hich\f3 \'b7\tab}}\pard \qt \fi-360\li1080\ri0\widctlpar\jclisttab\tx1080{\*\pn \pnlvlblt\ilvl0\ls1\pnrnot0\pnf3\pnstart1\pnindent360\pnsp120\pnhang{\pntxtb \'b7}}\aspalpha\aspnum\faauto\ls1\adjustright\rin0\lin1080\itap0 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 hbmp }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 จะเป็นตัวแปรที่จะเก็บตัวชี้ ที่ชี้ไปที่ส่วนหัวของรูปภาพ}{\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par {\pntext\pard\plain\fcs1 \af27\afs30 \fcs0 \fs30\loch\af3\hich\af3\dbch\af28 \loch\af3\dbch\af28\hich\f3 \'b7\tab}}\pard \qt \fi-360\li1080\ri0\widctlpar\jclisttab\tx1080{\*\pn \pnlvlblt\ilvl0\ls1\pnrnot0\pnf3\pnstart1\pnindent360\pnsp120\pnhang{\pntxtb \'b7}}\aspalpha\aspnum\faauto\ls1\adjustright\rin0\lin1080\itap0 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 height }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 จะเป็นการกำหนดส่วนสูงของรูปภาพ}{\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par {\pntext\pard\plain\fcs1 \af27\afs30 \fcs0 \fs30\loch\af3\hich\af3\dbch\af28 \loch\af3\dbch\af28\hich\f3 \'b7\tab}}\pard \qt \fi-360\li1080\ri0\widctlpar\jclisttab\tx1080{\*\pn \pnlvlblt\ilvl0\ls1\pnrnot0\pnf3\pnstart1\pnindent360\pnsp120\pnhang{\pntxtb \'b7}}\aspalpha\aspnum\faauto\ls1\adjustright\rin0\lin1080\itap0 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 width }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 จะเป็นการกำหนดส่วนกว้างของรูปภาพ}{\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par {\pntext\pard\plain\fcs1 \af27\afs30 \fcs0 \fs30\loch\af3\hich\af3\dbch\af28 \loch\af3\dbch\af28\hich\f3 \'b7\tab}}\pard \qt \fi-360\li1080\ri0\widctlpar\jclisttab\tx1080{\*\pn \pnlvlblt\ilvl0\ls1\pnrnot0\pnf3\pnstart1\pnindent360\pnsp120\pnhang{\pntxtb \'b7}}\aspalpha\aspnum\faauto\ls1\adjustright\rin0\lin1080\itap0 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 isvalid }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 จะบอกว่าไฟล์ที่โหลดเข้ามานั้นถูกต้องหรือไม่}{\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par }\pard \qt \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par }{\fcs1 \ab\af27\afs30 \fcs0 \b\f27\fs30 \hich\af27\dbch\af28\loch\f27 3.1.2}{\fcs0 \ab\af314\afs30 \fcs1 \b\f314\fs30\lang1054  ฟังก์ชัน }{\fcs1 \ab\af27\afs30 \fcs0 \b\f27\fs30 \hich\af27\dbch\af28\loch\f27 ~BitmapDC
\par }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \tab }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 จะทำหน้าที่เป็นฟังก์ชันดีสตรัคเตอร์ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 (Destructor) }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 ซึ่งจะเป็นฟังก์ชันที่จะถูกเรียกให้ทำงาน เมื่อสิ้นสุดการทำงานของออบเจ็กต์ในคลาสนั้นๆ เช่น การจบโปรแกรม หรือมีการลบออบเจ็กต์ออกจากหน่วยความจำ เป็นต้น ฟังก์ชันนี้จะใช้ชื่อเดียวกับชื่อคลาส แต่จะมีเครื่องหมาย }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 ~ }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 นำหน้าฟังก์ชัน ฟังก์ชันดีสตรัคเตอร์ของการโหลดรูปภาพบิตแมบจะแสดงด้านล่าง}{\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par 
\par }\pard\plain \s15\ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\af28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27  \tab BitmapDC :: ~BitmapDC () \{
\par \hich\af27\dbch\af28\loch\f27  \tab  RemoveBitmap ();
\par \hich\af27\dbch\af28\loch\f27  \tab \}
\par }{\fcs1 \af27 \fcs0 \f27 
\par }\pard\plain \qt \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\af28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 {\fcs1 \ab\af27\afs30 \fcs0 \b\f27\fs30 \hich\af27\dbch\af28\loch\f27 3.1.3}{\fcs0 \ab\af314\afs30 \fcs1 \b\f314\fs30\lang1054  ฟังก์ชัน }{\fcs1 \ab\af27\afs30 \fcs0 \b\f27\fs30 \hich\af27\dbch\af28\loch\f27 GetBits
\par }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \tab }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 จะเป็นฟังก์ชันในการขอตำแหน่งของหน่วยความจำ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 (Memory) }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 ที่มีอาเรย์ของรูปภาพบิตแมบเก็บอยู่ เพื่อสามารถใช้ในการแสดงผลต่อไป โดยจะมีการเรียกใช้งานดังนี้}{\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par 
\par }\pard\plain \s15\ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\af28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27  [1]\tab BYTE* BitmapDC :: GetBits () \{
\par \hich\af27\dbch\af28\loch\f27  [2]\tab  GdiFlush (); \tab // NT synchronization let GDI finish\hich\af27\dbch\af28\loch\f27  any in progress actions
\par \hich\af27\dbch\af28\loch\f27  [3]\tab  if (hbmpdc) return ptrbits;
\par \hich\af27\dbch\af28\loch\f27  [4]\tab  else return NULL;
\par \hich\af27\dbch\af28\loch\f27  [5]\tab \}
\par }\pard\plain \qt \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\af28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 \tab }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 โดยในบรรทัดที่ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 3, 4}{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054  จะการตรวจสอบว่ามรการโหลดรูปภาพเข้ามาหรือไม่ ถ้ามีก็ให้ส่งค่ากลับเป็น }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 ptrbits }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 ซึ่งจะเก็บค่าของบิตของข้อมูลรูปภาพ แต่ถ้าไม่มีกี่โหลดรูปเข้ามาก็ให้ส่งค่ามาเป็นค่าว่าง }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 (Null)
\par 
\par }{\fcs1 \ab\af27\afs30 \fcs0 \b\f27\fs30 \hich\af27\dbch\af28\loch\f27 3.1.4}{\fcs0 \ab\af314\afs30 \fcs1 \b\f314\fs30\lang1054  ฟังก์ชัน }{\fcs1 \ab\af27\afs30 \fcs0 \b\f27\fs30 \hich\af27\dbch\af28\loch\f27 Height
\par }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \tab }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 ทำหน้าที่ในการหาส่วนสูงของรูปภาพที่ทำการโหลดเข้ามา แล้วส่งค่ากลับออกมาเป็นค่าตัวเลข ภายใต้ชื่อตัวแปร }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 heigth }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 โดยฟังก์ชันนี้มีการเรียกใช้ดังนี้}{\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par 
\par }\pard\plain \s15\ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\af28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27  \tab long      BitmapDC :: Height () \{
\par \hich\af27\dbch\af28\loch\f27  \tab return height;
\par \hich\af27\dbch\af28\loch\f27  \tab \}
\par }\pard\plain \qt \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\af28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par }{\fcs1 \ab\af27\afs30 \fcs0 \b\f27\fs30 \hich\af27\dbch\af28\loch\f27 3.1.5}{\fcs0 \ab\af314\afs30 \fcs1 \b\f314\fs30\lang1054  ฟังก์ชัน }{\fcs1 \ab\af27\afs30 \fcs0 \b\f27\fs30 \hich\af27\dbch\af28\loch\f27 Width
\par }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27  \tab }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 ทำหน้าที่ในการหาความกว้างของรูปภาพที่ทำการโหลดเข้ามา แล้วส่งค่ากลับออกมาเป็นค่าตัวเลข ภายใต้ชื่อตัวแปร }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 width }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 โดยฟังก์ชันนี้มีการเรียกใช้ดังนี้}{\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par 
\par }\pard\plain \s15\ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\af28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27  \tab long      BitmapDC :: Width () \{
\par \hich\af27\dbch\af28\loch\f27  \tab return width;
\par \hich\af27\dbch\af28\loch\f27  \tab \}
\par }{\fcs1 \af27 \fcs0 \f27 
\par }\pard\plain \qt \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\af28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 {\fcs1 \ab\af27\afs30 \fcs0 \b\f27\fs30 \hich\af27\dbch\af28\loch\f27 3.1.6}{\fcs0 \ab\af314\afs30 \fcs1 \b\f314\fs30\lang1054  ฟังก์ชัน }{\fcs1 \ab\af27\afs30 \fcs0 \b\f27\fs30 \hich\af27\dbch\af28\loch\f27 TotalBits
\par }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \tab }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 ทำหน้าที่ในการหาขนาดของรูปภาพที่ทำการโหลดเข้ามา โดยจะนำค่าความสูงมาคูณกับค่าความกว้างของรูปภาพ โดยฟังก์ชันนี้มีการเรียกใช้ดังนี้}{\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par 
\par }\pard\plain \s15\ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\af28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27  \tab long      BitmapDC :: TotalBits () \{
\par \hich\af27\dbch\af28\loch\f27  \tab return height * width;
\par \hich\af27\dbch\af28\loch\f27  \tab \}
\par }\pard\plain \qt \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\af28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par }{\fcs1 \ab\af27\afs30 \fcs0 \b\f27\fs30 \hich\af27\dbch\af28\loch\f27 3.1.7}{\fcs0 \ab\af314\afs30 \fcs1 \b\f314\fs30\lang1054  ฟังก์ชัน }{\fcs1 \ab\af27\afs30 \fcs0 \b\f27\fs30 \hich\af27\dbch\af28\loch\f27 GetPixel
\par }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \tab }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 เป็นฟังก์ชันที่มีหน้าที่ในการส่งค่าของจุดสีแต่ละจุด โดยมีการสร้างพารามิเตอร์ในการรับค่าของสีเป็นตัวชี้ที่สร้างจากฟังก์ชัน }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 CPoint }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 ฟังก์ชันนี้มีการเรียกใช้งานดังนี้}{\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par 
\par }\pard\plain \s15\ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\af28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27  [1]\tab BYTE      BitmapDC :: GetPixel (CPoint &p) \{
\par \hich\af27\dbch\af28\loch\f27  [2]\tab long r;
\par \hich\af27\dbch\af28\loch\f27  [3]\tab  if (p.y >= height || p.y <0) return 0;
\par \hich\af27\dbch\af28\loch\f27  [4]\tab  if (p.x >= width  || p\hich\af27\dbch\af28\loch\f27 .x <0) return 0;
\par \hich\af27\dbch\af28\loch\f27  [5]\tab  r  = p.y * width + p.x;
\par \hich\af27\dbch\af28\loch\f27  [6]\tab  return (r >= TotalBits ()) ? (BYTE) 0 : *(ptrbits + r);
\par \hich\af27\dbch\af28\loch\f27  [7]\tab \}
\par }\pard\plain \qt \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\af28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par \tab }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 การทำงานของโปรแกรม บรรทัดที่ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 2}{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054  จะเป็นการกำหนดตัวแปรตัวหนึ่งให้มีชนิดเป็น }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 long }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 เพื่อใช้ในการหาค่าของจุดสี ในบรรทัดที่ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 3, 4, 5}{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054  และในบรรทัดที่ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 6}{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054  เป็นการหาว่าจุดที่เรากำลังพิจารณานั้นอยู่นอกรูปภาพหรือไม่ ถ้าอยู่ด้านนอกก็ให้ส่งค่าออกมาเป็น }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 0}{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054  แต่ถ้าอยู่ภายในรูปภาพที่ทำการโหลดขึ้นมาให้ส่งค่าเป็นค่าตัวชี้สีของจุดที่อยู่บนรูปภาพนั้น}{\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par 
\par }{\fcs1 \ab\af27\afs30 \fcs0 \b\f27\fs30 \hich\af27\dbch\af28\loch\f27 3.1.8}{\fcs0 \ab\af314\afs30 \fcs1 \b\f314\fs30\lang1054  ฟังก์ชัน }{\fcs1 \ab\af27\afs30 \fcs0 \b\f27\fs30 \hich\af27\dbch\af28\loch\f27 Read
\par }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \tab }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 เป็นฟังก์ชันที่ทำหน้าที่ในการโหลดรูปภาพบิตแมบ จากไฟล์รูปภาพที่ทำการเปิดขึ้นมา และทำการคัดลอกลงในส่วนของหน่วยความจำที่ใช้ในการเก็บค่าของจุดสีของรูปภาพ เพื่อสามารถใช้ในการแสดงผลต่อไป โดยการเรียกใช้งานฟังก์ชันนี้จะแสดงดังต่อไปนี้}{\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par 
\par }\pard\plain \s15\ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\af28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27  [1]\tab BOOL BitmapDC :: Read(CFile *ptrfile, Palette *ptrpalettes)
\par \hich\af27\dbch\af28\loch\f27  [2]\tab \{
\par \hich\af27\dbch\af28\loch\f27  \tab 
\par \hich\af27\dbch\af28\loch\f27  [3]\tab  // CFile file;
\par \hich\af27\dbch\af28\loch\f27  [4]\tab  CFileException file_err; // used if more info on errors is desired
\par \hich\af27\dbch\af28\loch\f27  [5]\tab  //file.Open (filename, CFile::modeRead, &file_err);
\par \hich\af27\dbch\af28\loch\f27  [6]\tab  //file = ptrfile;
\par \hich\af27\dbch\af28\loch\f27  [7]\tab  BITMAPFILEHEADER bmfh;
\par \hich\af27\dbch\af28\loch\f27  [8]\tab  UINT             actsz;
\par \hich\af27\dbch\af28\loch\f27  \tab 
\par \hich\af27\dbch\af28\loch\f27  [9]\tab  HANDLE hdib\hich\af27\dbch\af28\loch\f27  = 0;
\par \hich\af27\dbch\af28\loch\f27  [10]\tab  // input the BITMAPFILEHEADER structure
\par \hich\af27\dbch\af28\loch\f27  [11]\tab  actsz = ptrfile->Read ((LPSTR) &bmfh, sizeof (BITMAPFILEHEADER));
\par \hich\af27\dbch\af28\loch\f27  [12]\tab  // verify it is a .BMP file
\par \hich\af27\dbch\af28\loch\f27  [13]\tab  if (actsz != sizeof (BITMAPFILEHEADER) || bmfh.bfType != * (WORD *) "BM") \{
\par \hich\af27\dbch\af28\loch\f27  [14]\tab   AfxM\hich\af27\dbch\af28\loch\f27 essageBox ("Invalid bmp game file", MB_OK);
\par \hich\af27\dbch\af28\loch\f27  [15]\tab   //ptrfile->Close ();
\par \hich\af27\dbch\af28\loch\f27  [16]\tab   return FALSE;
\par \hich\af27\dbch\af28\loch\f27  [17]\tab  \}
\par \hich\af27\dbch\af28\loch\f27  [18] \tab  // calculate the size of the file less the file header
\par \hich\af27\dbch\af28\loch\f27  [19]\tab  // and allocate memory for the dib
\par \hich\af27\dbch\af28\loch\f27  [20]\tab  DWORD dwDibSize = bmfh.bfSize - sizeof (\hich\af27\dbch\af28\loch\f27 BITMAPFILEHEADER);
\par \hich\af27\dbch\af28\loch\f27  [21]\tab  hdib = GlobalAlloc (GMEM_MOVEABLE, dwDibSize);
\par \hich\af27\dbch\af28\loch\f27  [22]\tab  BYTE *ptrdib = (BYTE*) GlobalLock (hdib);
\par \hich\af27\dbch\af28\loch\f27  [23]\tab  if (!ptrdib) \{
\par \hich\af27\dbch\af28\loch\f27  [24]\tab   AfxMessageBox ("Cannot allocate memory for bmp file", MB_OK);
\par \hich\af27\dbch\af28\loch\f27  [25]\tab   //ptrfile->Close ();
\par \hich\af27\dbch\af28\loch\f27  [26]\tab   if (h\hich\af27\dbch\af28\loch\f27 dib) GlobalFree (hdib);
\par \hich\af27\dbch\af28\loch\f27  [27]\tab   return FALSE;
\par \hich\af27\dbch\af28\loch\f27  [28]\tab  \}
\par \hich\af27\dbch\af28\loch\f27  \tab  
\par \hich\af27\dbch\af28\loch\f27  [29]\tab  // read in the rest of the DIB - 
\par \hich\af27\dbch\af28\loch\f27  [30]\tab  actsz = ptrfile->Read ((LPSTR) ptrdib, dwDibSize);
\par \hich\af27\dbch\af28\loch\f27  [31]\tab  //ptrfile->Close ();
\par \hich\af27\dbch\af28\loch\f27  [32]\tab  if (actsz != dwDibSize) \{ // error, wrong number of bytes
\par \hich\af27\dbch\af28\loch\f27  [33]\tab \hich\af27\dbch\af28\loch\f27   AfxMessageBox ("Invalid bmp game file", MB_OK);
\par \hich\af27\dbch\af28\loch\f27  [34]\tab   GlobalUnlock (hdib);
\par \hich\af27\dbch\af28\loch\f27  [35]\tab   GlobalFree (hdib);
\par \hich\af27\dbch\af28\loch\f27  [36]\tab   return FALSE;
\par \hich\af27\dbch\af28\loch\f27  [37]\tab  \}
\par \hich\af27\dbch\af28\loch\f27  \tab  
\par \hich\af27\dbch\af28\loch\f27  [38]\tab  // check the validity of the size of the info header - fail OS2 bitmaps
\par \hich\af27\dbch\af28\loch\f27  [39]\tab  if (((BITMAPINFOHEADER*) ptr\hich\af27\dbch\af28\loch\f27 dib)->biSize <= sizeof(BITMAPCOREHEADER)) \{
\par \hich\af27\dbch\af28\loch\f27  [40]\tab   AfxMessageBox ("Invalid bmp game file", MB_OK);
\par \hich\af27\dbch\af28\loch\f27  [41]\tab   GlobalUnlock (hdib);
\par \hich\af27\dbch\af28\loch\f27  [42]\tab   GlobalFree (hdib);
\par \hich\af27\dbch\af28\loch\f27  [43]\tab   return FALSE;
\par \hich\af27\dbch\af28\loch\f27  [44]\tab  \}
\par \hich\af27\dbch\af28\loch\f27  \tab  
\par \hich\af27\dbch\af28\loch\f27  [45]\tab  WORD bitcount = ((BITMAPINFOHEADER*) ptrdib)->biBitCount;
\par \hich\af27\dbch\af28\loch\f27  [46]\tab  DWORD numcolors = ((BITMAPINFOHEADER*) ptrdib)->biClrUsed;
\par \hich\af27\dbch\af28\loch\f27  [47]\tab  if (numcolors == 0 && bitcount != 24) numcolors = 1L << bitcount;
\par \hich\af27\dbch\af28\loch\f27  [48]\tab  if (numcolors == 0) \{
\par \hich\af27\dbch\af28\loch\f27  [49]\tab   AfxMessageBox ("Invalid bmp game file", MB_OK);
\par \hich\af27\dbch\af28\loch\f27  [50]\tab   GlobalUnlock (hdib);
\par \hich\af27\dbch\af28\loch\f27  [5\hich\af27\dbch\af28\loch\f27 1]\tab   GlobalFree (hdib);
\par \hich\af27\dbch\af28\loch\f27  [52]\tab   return FALSE;
\par \hich\af27\dbch\af28\loch\f27  [53]\tab  \}
\par 
\par \hich\af27\dbch\af28\loch\f27  [54]\tab  width = ((BITMAPINFOHEADER*) ptrdib)->biWidth;
\par \hich\af27\dbch\af28\loch\f27  [55]\tab  height = ((BITMAPINFOHEADER*) ptrdib)->biHeight;
\par \hich\af27\dbch\af28\loch\f27  \tab  
\par \hich\af27\dbch\af28\loch\f27  [56]\tab  //////////////////////////
\par \hich\af27\dbch\af28\loch\f27  [57]\tab  // modify Color Palette
\par \hich\af27\dbch\af28\loch\f27  [58]\tab  //////////////\hich\af27\dbch\af28\loch\f27 ////////////
\par \hich\af27\dbch\af28\loch\f27  [59]\tab  ptrpalettes->SetPalette(ptrdib);
\par \hich\af27\dbch\af28\loch\f27  [60]\tab  //////////////////////////
\par \hich\af27\dbch\af28\loch\f27  \tab 
\par \hich\af27\dbch\af28\loch\f27  [61] \tab  if (!Create (width, height, ptrpalettes)) \{
\par \hich\af27\dbch\af28\loch\f27  [62]\tab   GlobalUnlock (hdib);
\par \hich\af27\dbch\af28\loch\f27  [63]\tab   GlobalFree (hdib);
\par \hich\af27\dbch\af28\loch\f27  [64]\tab   return FALSE;
\par \hich\af27\dbch\af28\loch\f27  [65]\tab  \}
\par \hich\af27\dbch\af28\loch\f27  \tab 
\par }\pard \s15\ql \fi-720\li720\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin720\itap0 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27  [66]\tab  BYTE *ptrsrc = pt\hich\af27\dbch\af28\loch\f27 rdib + ((BITMAPINFOHEADER*) ptrdib)->biSize + numcolors * sizeof  (RGBQUAD);
\par }\pard \s15\ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27  [67]\tab  BYTE *ptrdes = GetBits ();
\par \hich\af27\dbch\af28\loch\f27  [68]\tab  long i = 0;
\par \hich\af27\dbch\af28\loch\f27  \tab  
\par \hich\af27\dbch\af28\loch\f27  [69]\tab  ptrsrc += (height -1) * width;
\par \hich\af27\dbch\af28\loch\f27  [70]\tab  while (i < height) \{
\par \hich\af27\dbch\af28\loch\f27  [71]\tab   memcpy (ptrdes, ptrsrc, width);
\par \hich\af27\dbch\af28\loch\f27  [72]\tab   ptrsrc -\hich\af27\dbch\af28\loch\f27 = width;
\par \hich\af27\dbch\af28\loch\f27  [73]\tab   ptrdes += width;
\par \hich\af27\dbch\af28\loch\f27  [74]\tab   i++;
\par \hich\af27\dbch\af28\loch\f27  [75]\tab  \}
\par 
\par \hich\af27\dbch\af28\loch\f27  [76]\tab  // Delete error bit for 32 bit CreateDIBsection function
\par \hich\af27\dbch\af28\loch\f27  [77]\tab  ptrdes = GetBits();
\par \hich\af27\dbch\af28\loch\f27  [78]\tab  long wold = ((BITMAPINFOHEADER*) ptrdib)->biWidth;
\par \hich\af27\dbch\af28\loch\f27  [79]\tab  int wdif = width - wold;
\par \hich\af27\dbch\af28\loch\f27  [80]\tab  for ( i=0; \hich\af27\dbch\af28\loch\f27 i<height; i++)  \{
\par \hich\af27\dbch\af28\loch\f27  [81]\tab    for (int j=wdif; j>0; j--)  \{
\par \hich\af27\dbch\af28\loch\f27  [82]\tab       ptrdes[(i*width)+wold+j-1] = 255;
\par \hich\af27\dbch\af28\loch\f27  [83]\tab    \}
\par \hich\af27\dbch\af28\loch\f27  [84]\tab  \}
\par \hich\af27\dbch\af28\loch\f27  \tab 
\par \hich\af27\dbch\af28\loch\f27  [85]\tab  GlobalUnlock (hdib);
\par \hich\af27\dbch\af28\loch\f27  [86]\tab  GlobalFree (hdib);
\par \hich\af27\dbch\af28\loch\f27  [87]\tab  return TRUE;
\par \hich\af27\dbch\af28\loch\f27  [88]\tab \}
\par }\pard\plain \qt \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\af28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par \tab }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 การทำการของโปรแกรมในช่วงบรรทัดที่ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 3}{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054  ถึงบรรทัดที่ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 17 }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 จะแสดงถึงการโหลดไฟล์รูปภาพขึ้นมา โดยในตอนนี้จะเริ่มอ่านในส่วนหัวของไฟล์ก่อนว่าเป็นรูปภาพที่ถูกต้องหรือไม่ จากนั้นในช่วงบรรทัดที่ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 18 }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 ถึง }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 28 }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 จะเป็นการอ่านไฟล์ในส่วนต้นว่า ไฟล์ที่ทำหารโหลดเข้ามานี้มีขนาดเท่าใด เพื่อทำการจองพื้นที่ของหน่วยความจำหลักให้กับรูปภาพ ถ้าไม่สามารถจองพื้นที่ของหน่วยความจำได้ก็จะมีการขึ้นข้อความว่า }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \loch\af27\dbch\af28\hich\f27 \loch\f27 \hich\f27 \loch\f27 Cannot allocate memory for bmp file }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 บนหน้าจอ}{\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par \tab }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 บรรทัดที่ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 29}{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054  ถึง }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 37}{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054  จะมีทำการตรวจสอบว่ารูปภาพที่ทำการโหลดเข้ามานั้นถูกต้องหรือไม่ ถ้าไม่ถูกต้องก็จะขึ้นข้อความ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \loch\af27\dbch\af28\hich\f27 \loch\f27 \hich\f27 \loch\f27 Invalid bmp game file }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 บรรทัดที่ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 38 }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 ถึง }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 44 }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 จะเช็คความถูกต้องของรูปภาพที่เป็นลักษณะ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 OS2 }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 ถ้ามีความผิดพลาดก็จะขึ้นข้อความเช่นเดียวกับด้านบน บรรทัดที่ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 45 }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 ถึง }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 53 }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 จะทำการเช็คสีของรูปภาพว่าถูกต้องหรือไม่ ถ้าไม่ถูกต้องก็จะขึ้นข้อความเช่นเดียวกับด้านบนเช่นกัน บรรทัดที่ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 54 }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 และ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 55 }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 จะเป็นการกำหนดค่าความสูงและค่าความกว้างของรูปภาพที่โหลดเข้ามา โดยเก็บในตัวแปร }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 height }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 และตัวแปร }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 width }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 ตามลำดับ}{\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par \tab }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 ในบรรทัดที่ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 56}{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054  ถึง }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 65}{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054  จะเป็นการเช็คความผิดพลาดที่เกิดจากการโหลดค่าของจุดสีที่เกิดขึ้นว่า สีที่ได้ตรงกันหรือไม่ ส่วนในบรรทัดที่ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 66}{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054  ถึง }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 75}{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054  จะทำการกำหนดตัวชี้เพื่อชี้ไปยังข้อมูลอาเรย์ของรูปภาพที่โหลดเข้ามา โดยจะจะทำการคัดลอกตัวชี้เก่า }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 (ptrsrc) }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 ไปยังตัวชี้ใหม่ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 (ptrdes) }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 สุดท้ายในบรรทัดที่ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 76}{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054  ถึง }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 88}{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054  จะเป็นการลบความผิดพลาดของบิตที่เกิดขึ้น โดยจะกำหนดจุดที่ผิดพลาดให้เป็นสีขาวแทน}{\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par 
\par }{\fcs1 \ab\af27\afs30 \fcs0 \b\f27\fs30 \hich\af27\dbch\af28\loch\f27 3.1.9}{\fcs0 \ab\af314\afs30 \fcs1 \b\f314\fs30\lang1054  ฟังก์ชัน }{\fcs1 \ab\af27\afs30 \fcs0 \b\f27\fs30 \hich\af27\dbch\af28\loch\f27 SetBits
\par }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \tab }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 เป็นฟังก์ชันที่ใช้ในการกำหนดค่าของตัวชี้ของรูปภาพบิตแมบที่ทำการโหลดขึ้นมา โดยให้ตัวชี้นั้นชี้ไปที่อาเรย์ที่เก็บข้อมูลของรูปภาพ และทำการคัดลอกข้อมูลจากตัวชี้เก่า }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 (ptrsrc) }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 ไปยังตัวชี้ใหม่ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 (ptrdes) }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 การเรียกใช้งานฟังก์ชันนี้ทำได้ดังนี้}{\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par }\pard\plain \s15\ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\af28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27  \tab void BitmapDC::SetBits(BYTE * ptrs\hich\af27\dbch\af28\loch\f27 rc)
\par \hich\af27\dbch\af28\loch\f27  \tab \{
\par }\pard \s15\ql \fi-720\li720\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin720\itap0 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27  \tab  //BYTE *ptrsrc = ptrdib + ((BITMAPINFOHEADER*) ptrdib)->biSize + numcolors * sizeof (RGBQUAD);
\par }\pard \s15\ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27  \tab  BYTE *ptrdes = GetBits ();
\par \hich\af27\dbch\af28\loch\f27  \tab  long i = 0;
\par \hich\af27\dbch\af28\loch\f27  \tab  
\par \hich\af27\dbch\af28\loch\f27  \tab  //ptrsrc += (height -1) * width;
\par \hich\af27\dbch\af28\loch\f27  \tab  while (i < height) \{
\par \hich\af27\dbch\af28\loch\f27  \tab   memcpy (ptrdes, ptrsrc, widthOrg);
\par \hich\af27\dbch\af28\loch\f27  \tab \hich\af27\dbch\af28\loch\f27 ptrsrc += widthOrg;
\par \hich\af27\dbch\af28\loch\f27  \tab ptrdes += widthOrg;
\par \hich\af27\dbch\af28\loch\f27  \tab   for(int j=widthOrg; j<width; j++) \{
\par \hich\af27\dbch\af28\loch\f27  \tab     memset(ptrdes, 255, 1);
\par \hich\af27\dbch\af28\loch\f27  \tab     ptrdes++;
\par \hich\af27\dbch\af28\loch\f27  \tab \}
\par \hich\af27\dbch\af28\loch\f27  \tab i++;
\par }{\fcs1 \af27 \fcs0 \f27 \hich\af27\dbch\af28\loch\f27  \tab \}
\par }\pard\plain \qt \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\af28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par }{\fcs1 \ab\af27\afs30 \fcs0 \b\f27\fs30 \hich\af27\dbch\af28\loch\f27 3.2 }{\fcs0 \ab\af314\afs30 \fcs1 \b\f314\fs30\lang1054 การจัดการรูปฮิสโตแกรม}{\fcs1 \ab\af27\afs30 \fcs0 \b\f27\fs30 
\par }\pard\plain \s16\qt \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af33\afs30\cgrid\langnp1033\langfenp1033 \fcs0 \fs30\lang1033\langfe1033\loch\af28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 {\fcs1 \af27 \fcs0 \f27 \tab }{\fcs0 \af314 \fcs1 \f314\fs30\lang1054 การจัดการรูปฮิสโตแกรม ในที่เราศึกษาและนำมาใช้หมายถึง การสร้างกราฟที่บอกถึงจำนวนสีที่มีในแต่ละแถว โดยสามารถทำได้ดังนี้}{\fcs1 \af27 \fcs0 \f27 
\par }\pard\plain \qt \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\af28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par }\pard\plain \s15\ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\af28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27  [1]\tab void CProjectView ::OnEditHistogram()  [2]\tab \{
\par \hich\af27\dbch\af28\loch\f27  [3]\tab \tab int his[600]; [4]\tab \tab int i; [5]\tab \tab int j;
\par \hich\af27\dbch\af28\loch\f27  [6]\tab if (!hasHi\hich\af27\dbch\af28\loch\f27 stogram)
\par \hich\af27\dbch\af28\loch\f27  [7]\tab \{
\par \hich\af27\dbch\af28\loch\f27  [8]\tab \tab for (j=0;j<pbBitmap.Height();j++)
\par \hich\af27\dbch\af28\loch\f27  [9]\tab \tab \{
\par \hich\af27\dbch\af28\loch\f27  [10]\tab \tab \tab his[j]=0;
\par \hich\af27\dbch\af28\loch\f27  [11]\tab \tab \tab for (i=0;i<pbBitmap.Width();i++)
\par \hich\af27\dbch\af28\loch\f27  [12]\tab \tab \tab \{
\par \hich\af27\dbch\af28\loch\f27  [13]\tab \tab \tab \tab if (pBitmap[i+pbBitmap.Width()*j] == 0)
\par \hich\af27\dbch\af28\loch\f27  [14]\tab \tab \tab \tab \{
\par \hich\af27\dbch\af28\loch\f27  [15]\tab \tab \tab \tab \tab his[j]++;
\par \hich\af27\dbch\af28\loch\f27  [16]\tab \tab \tab \tab \}
\par \hich\af27\dbch\af28\loch\f27  [17]\tab \tab \tab \}
\par \hich\af27\dbch\af28\loch\f27  [18]\tab \tab \}
\par \hich\af27\dbch\af28\loch\f27  [19]\tab \tab for(j=\hich\af27\dbch\af28\loch\f27 0;j<pbBitmap.Height();j++)
\par \hich\af27\dbch\af28\loch\f27  [20]\tab \tab \{
\par \hich\af27\dbch\af28\loch\f27  [21]\tab \tab \tab for (i=0;i<pbBitmap.Width();i++)
\par \hich\af27\dbch\af28\loch\f27  [22]\tab \tab \tab \{
\par \hich\af27\dbch\af28\loch\f27  [23]\tab \tab \tab \tab if (his[j] != 0)
\par \hich\af27\dbch\af28\loch\f27  [24]\tab \tab \tab \tab \{
\par \hich\af27\dbch\af28\loch\f27  [25]\tab \tab \tab \tab \tab pHistogram[i+pbBitmap.Width()*j]=0;
\par \hich\af27\dbch\af28\loch\f27  [26]\tab \tab \tab \tab \tab his[j]--;
\par \hich\af27\dbch\af28\loch\f27  [27]\tab \tab \tab \tab \}
\par \hich\af27\dbch\af28\loch\f27  \tab \tab \tab \tab else [28]\tab \tab \tab \tab \tab pHistogram[i+pbBitmap.Width()*j]=25\hich\af27\dbch\af28\loch\f27 5;
\par \hich\af27\dbch\af28\loch\f27  [29]\tab \tab \tab \}
\par \hich\af27\dbch\af28\loch\f27  [30]\tab \tab \}
\par \hich\af27\dbch\af28\loch\f27  [31]\tab \tab hasHistogram=TRUE;
\par \hich\af27\dbch\af28\loch\f27  [32]\tab \}\tab 
\par \hich\af27\dbch\af28\loch\f27  [33]\tab \tab pbBitmap.SetBits((BYTE*)&pHistogram);
\par \hich\af27\dbch\af28\loch\f27  [34]\tab \tab // however we must set pointer to pHistogram anyway...
\par \hich\af27\dbch\af28\loch\f27  [35]\tab \tab // now gonna get how much line in the document
\par \hich\af27\dbch\af28\loch\f27  [36]\tab /*
\par \hich\af27\dbch\af28\loch\f27  [37]\tab this part is 1's.
\par \hich\af27\dbch\af28\loch\f27  [38]\tab \hich\af27\dbch\af28\loch\f27 int line=0;
\par \hich\af27\dbch\af28\loch\f27  [39]\tab */
\par }{\fcs1 \af27 \fcs0 \f27 \hich\af27\dbch\af28\loch\f27  [40]\tab Histogram=TRUE; [41]\tab GetDocument()->UpdateAllViews(NULL); [42]\tab \}\tab }{\fcs0 \af314 \fcs1 \f314\fs28\lang1054 ในบรรทัดที่ }{\fcs1 \af27 \fcs0 \f27 \hich\af27\dbch\af28\loch\f27 3 }{\fcs0 \af314 \fcs1 \f314\fs28\lang1054 ถึง }{\fcs1 \af27 \fcs0 \f27 \hich\af27\dbch\af28\loch\f27 5 }{\fcs0 \af314 \fcs1 \f314\fs28\lang1054 จะเป็นการกำหนดค่าตัวแปรที่จะใช้ โดยเราจะกำหนดให้ค่า }{\fcs1 \af27 \fcs0 \f27 \hich\af27\dbch\af28\loch\f27 his }{\fcs0 \af314 \fcs1 \f314\fs28\lang1054 เป็นตัวแปรที่ใช้เก็บข้อมูล มีขนาด }{\fcs1 \af27 \fcs0 \f27 \hich\af27\dbch\af28\loch\f27 600 }{\fcs0 \af314 \fcs1 \f314\fs28\lang1054 และให้ }{\fcs1 \af27 \fcs0 \f27 \hich\af27\dbch\af28\loch\f27 i }{\fcs0 \af314 \fcs1 \f314\fs28\lang1054 และ }{\fcs1 \af27 \fcs0 \f27 \hich\af27\dbch\af28\loch\f27 j }{\fcs0 \af314 \fcs1 \f314\fs28\lang1054 เป็นตัวนับ บรรทัดที่ }{\fcs1 \af27 \fcs0 \f27 \hich\af27\dbch\af28\loch\f27 6 }{\fcs0 \af314 \fcs1 \f314\fs28\lang1054 เป็นการกำหนดเงื่อนไขในการทำฮิสโตแกรม คือ ถ้ามีการทำฮิสโตแกรมมาแล้วก็จะไม่ต้องทำอีก เพราะจะเสียเวลามาก ในบรรทัดที่ }{\fcs1 \af27 \fcs0 \f27 \hich\af27\dbch\af28\loch\f27 8}{\fcs0 \af314 \fcs1 \f314\fs28\lang1054  ถึง }{\fcs1 \af27 \fcs0 \f27 \hich\af27\dbch\af28\loch\f27 18}{\fcs0 \af314 \fcs1 \f314\fs28\lang1054  จะเป็นการวนลูปเพื่อหาว่าในบรรทัดนั้นๆของรูปภาพ มีจำนวนจุดที่เป็นสีดำเท่าใด เมื่อได้จำนวนจุดที่เป็นสีดำในแต่ละบรรทัดแล้วก็ให้เก็บค่าลงในตัวแปร }{\fcs1 \af27 \fcs0 \f27 \hich\af27\dbch\af28\loch\f27 his }{\fcs0 \af314 \fcs1 \f314\fs28\lang1054 ทำเช่นนี้ต่อไปจนสุดรูปภาพ}{\fcs1 \af27 \fcs0 \f27 
\par }\pard\plain \qt \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\af28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 \tab }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 บรรทัดที่ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 19}{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054  ถึง }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 30}{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054  จะเป็นการนำค่าที่อยู่ในตัวแปร }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 his }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 ที่มีข้อมูลจำนวนจุดที่เป็นสีดำในแต่ละบรรทัดมาวาดเป็นรูปกราฟฮิสโตแกรมในแนวนอน เพราะเป็นการหาค่าจุดสีในแนวนอนเป็นแต่ละบรรทัด โดยในการวนลูปนั้น ถ้าค่าของตัวแปร }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 his }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 ไม่เป็น }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 0}{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054  ก็ให้เขียนสีดำลงไป แต่ถ้าในตัวแปรมีค่าเป็น }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 0}{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054  ก็ให้เขียนสีขาวลงไป ทำเช่นนี้จนสุดรูปภาพ}{\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par \tab }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 บรรทัดที่ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 31}{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054  เป็นการกำหนดตัวแปร }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 hasHistogram }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 เพื่อบอกว่ารูปนี้ได้มีการทำฮิสโตแกรมไปแล้วจะได้ไม่ต้องมาทำซ้ำอีก บรรทัดที่ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 33}{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054  เป็นการกำหนดให้ตัวชี้ของรูปภาพในการอแสดงผล มาชี้ที่รูปฮิสโตแกรมที่เราสร้างขึ้นมา ส่วนบรรทัดที่ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 41}{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054  เป็นการกำหนดการเปลี่ยนแปลงรูปบนหน้าจอ}{\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par 
\par }{\fcs1 \ab\af27\afs30 \fcs0 \b\f27\fs30 \hich\af27\dbch\af28\loch\f27 3.3 }{\fcs0 \ab\af314\afs30 \fcs1 \b\f314\fs30\lang1054 การแสดงผลรูปภาพบนหน้าจอ}{\fcs1 \ab\af27\afs30 \fcs0 \b\f27\fs30 
\par }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \tab }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 ในฟังก์ชันของการวาดรูปภาพลงบนหน้าจอคอมพิวเตอร์ เราจะใช้ฟังก์ชันสำเร็จรูปของ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 MFC }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 คือ ฟังก์ชัน }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 BitBlt }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 โดยจะมีวิธีการใช้ดังนี้}{\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par 
\par }\pard\plain \s15\ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\af28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27  [1]\tab void CProjectView::OnDraw(CDC* pDC) [2]\tab \{ [3]\tab \tab CProjectDoc* pDoc = GetDocument(); [4]\tab \tab ASSERT_VALI\hich\af27\dbch\af28\loch\f27 D(pDoc);
\par \hich\af27\dbch\af28\loch\f27  \tab 
\par \hich\af27\dbch\af28\loch\f27  [5]\tab \tab int nHeight; [6]\tab \tab int nWidth; \tab  [7]\tab \tab if (Ready) [8]\tab \tab \{ [9]\tab \tab \tab nHeight=pbBitmap.Height(); [10]\tab \tab \tab nWidth=pbBitmap.Width(); \tab  [11]\tab \tab \tab BitBlt(pDC->m_hDC,0,0,nWidth,nHeight,pbBitmap.hbmpdc,0,0,SRCCOPY); [12]\tab \tab \tab CSize sizePic;
\par \hich\af27\dbch\af28\loch\f27  [13]\tab \tab \tab siz\hich\af27\dbch\af28\loch\f27 ePic.cx=nWidth;
\par \hich\af27\dbch\af28\loch\f27  [14]\tab \tab \tab sizePic.cy=nHeight;
\par \hich\af27\dbch\af28\loch\f27  [15]\tab \tab \tab SetScrollSizes(MM_TEXT,sizePic);
\par \hich\af27\dbch\af28\loch\f27  [16]\tab \tab \}
\par \hich\af27\dbch\af28\loch\f27  [17]\tab \}
\par }\pard\plain \qt \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fcs1 \af28\afs28\cgrid\langnp1033\langfenp1033 \fcs0 \fs28\lang1033\langfe1033\loch\af28\hich\af28\dbch\af28\cgrid\langnp1033\langfenp1033 {\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par \tab }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 ในบรรทัดที่ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 3 }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 และ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 4 }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 จะเป็นการกำหนดให้มีการแสดงผลในรูปแบบโครงสร้างเอกสาร }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 (Document Architecture) }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 เพื่อความสะดวกในการใช้งาน บรรทัดที่ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 5 }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 และ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 6 }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 เป็นการประกาศตัวแปรเพื่อใช้เก็บค่าของความสูงและความกว้างของรูปภาพ บรรทัดที่ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 9 }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 และ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 10 }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 เป็นการกำหนดค่าของความสูงและความกว้างของรูปภาพจากรูปภาพที่จะแสดงบนหน้าจอ บรรทัดที่ }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 11 }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 ถึง }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 17 }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 เป็นรูปแบบของการเรียกใช้ฟังก์ชัน }{\fcs1 \af27\afs30 \fcs0 \f27\fs30 \hich\af27\dbch\af28\loch\f27 BitBlt }{\fcs0 \af314\afs30 \fcs1 \f314\fs30\lang1054 เพื่อวาดรูปภาพลงบนหน้าจอคอมพิวเตอร์}{\fcs1 \af27\afs30 \fcs0 \f27\fs30 
\par }}