#!/bin/sh
## ###############################################################
## 
## Module          : Functional Test Driver
## Filename        : main.sh
## Author          : generated by DBDK
## PURPOSE
##    Main Testsuite driver. This file lets you run all functional
##    test for this datablade.
##    The following command line options are supported:
##
##      main.sh all
##          Builds, runs all tests and cleans up. A shortcut
##          for invoking the "build", "run" and "clean" target.
##      main.sh build
##          Runs the setup.sql script, which builds the 
##          test tables and loads test data into it.
##      main.sh run
##          Runs all tests. Test output is saved in .log files
##          and compared to reference files (.req) is existing.
##          If log and reference file is identical "test passed"
##          is printed, if different "test failed". If no
##          reference file exists, "unknown" is displayed.
##      main.sh clean
##          Removes all log and error files.
##      main.sh save
##          Saves all log files as reference files. Existing
##          reference files are lost! You should save log
##          files as reference files ONLY if you have inspected
##          them and are sure they are correct.
## 
## ###############################################################


if [ ! -n "${TESTDB-}" ]
then
    echo You must set the environment variable TESTDB
    exit 1
fi


if [ -n "${windir-}" ]
then
    if [ ! -n "${DBSERVER-}" ]
    then
	echo You must set the environment variable DBSERVER
	exit 1
    fi
fi

ORIG_DIR=`pwd`
TEST_ROOT=`dirname $0`

for i in $TEST_ROOT/opaque/* $TEST_ROOT/udr/* $TEST_ROOT/cast/*
do
    if [ -d $i ]
    then 
	cd $i
	pwd
	main.sh $*
	cd $ORIG_DIR
    fi
done	

## ###############################################################
## EOF                                                            
## ###############################################################
